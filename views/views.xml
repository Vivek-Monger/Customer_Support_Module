<odoo>
   <!-- KANBAN VIEW -->
    <record id="customer_support_module_kanban_view" model="ir.ui.view">
        <field name="name">customer.support.module.kanban.view</field>
        <field name="model">customer.support.module</field>
        <field name="arch" type="xml">
            <kanban default_group_by="phase_id" class="o_kanban_grouped" group_create="true" group_expand="1">
                <field name="subject"/>
                <field name="description"/>
                <field name="date"/>
                <field name="phase_id"/>
                <field name="priority"/>
                <field name="user_id"/>
                <field name="assigned_user_id"/>
                <field name="agent_reply"/>
                <templates>
                    <t t-name="kanban-box">
                        <div class="oe_kanban_global_click o_kanban_record"
                             style="border: 1px solid #ddd; border-radius: 10px; padding: 10px; margin: 5px; background-color: white; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                             <div><strong>Created By:</strong> <field name="user_id"/></div>
                            <div style="display: flex; align-items: center; justify-content: space-between;">

                                <strong><field name="subject"/></strong>
                                <field name="assigned_user_id" widget="many2one_avatar_user" options="{'no_open': True}" style="height: 24px; width: 24px; border-radius: 50%;"/>

                            </div>
                            
                            <!-- <div style="margin-top: 5px; color: #666;">
                                <field name="description"/>
                            </div>-->
                            <div style="margin-top: 5px; font-size: 13px; color: #555;">
                                <strong>Agent Reply:</strong> <field name="agent_reply"/>
                            </div>
                            <div style="margin-top: 5px; font-size: 13px; color: #888;">
                                <i class="fa fa-calendar" style="margin-right: 3px;"/> <field name="date"/>
                            </div>
                            <div style="margin-top: 8px;">
                                <field name="priority" widget="priority" readonly = "1"/>
                            </div>

                           <!-- <div style="display: flex; justify-content: flex-end; gap: 5px; margin-top: 10px;">
                                <button name="edit_ticket" type="object" string="Edit" icon="fa-pencil"/>
                                <button name="action_confirm_delete" type="object" string="Delete" icon="fa-trash" class="btn-danger"/>
                            </div> --> 

                        </div>
                        
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

   <!-- LIST VIEW -->
<record id="customer_support_module_list_view" model="ir.ui.view">
    <field name="name">customer.support.module.list.view</field>
    <field name="model">customer.support.module</field>
    <field name="arch" type="xml">
        <list>
            <!-- Ticket subject visible to all -->
            <field name="subject"/>
            
            <!-- Assigned To: only for Customer and Manager/Admin -->
            <field name="assigned_user_id"
                   string="Assigned To"
                   groups="customer_support_module.group_support_customer,
                           customer_support_module.group_support_manager,
                           customer_support_module.group_support_admin"/>
            
            <!-- Created By: only for Agent and Manager/Admin -->
            <field name="user_id"
                   string="Created By"
                   groups="customer_support_module.group_support_agent,
                           customer_support_module.group_support_manager,
                           customer_support_module.group_support_admin"/>
            
            <!-- Priority always visible -->
            <field name="priority" widget="priority"/>
            
            <!-- Agent Reply: visible to Agent and Manager/Admin -->
            <field name="agent_reply"
                   groups="customer_support_module.group_support_agent,
                           customer_support_module.group_support_manager"/>
            
            <!-- Date: visible to all -->
            <field name="date"/>
            
            <!-- Phase: visible to Agent and Manager/Admin -->
            <field name="phase_id"
                   groups="customer_support_module.group_support_agent,
                           customer_support_module.group_support_manager"/>
        </list>
    </field>
</record>


    <!-- Form View-->
    <record id="customer_support_module_form_view" model="ir.ui.view">
    <field name="name">customer.support.module.form.view</field>
    <field name="model">customer.support.module</field>
    <field name="arch" type="xml">
        <form string="Support Ticket" >
            
            <sheet>
                <group>
                    <field name="subject" placeholder="Enter your issue subject..." required="1"/>
                    <field name="description"/>
                    <field name="date"/>
                    <field name="user_id" readonly="1"/>
                </group>

                <group string="Assignment &amp; Priority">
                    <field name="assigned_user_id"
                           groups="customer_support_module.group_support_manager,
                                   customer_support_module.group_support_admin"/>
                    <field name="assigned_user_id" readonly="1"
                           groups="customer_support_module.group_support_agent,
                                   customer_support_module.group_support_customer"/>
                    <field name="priority"
                           groups="customer_support_module.group_support_customer" widget="priority"/>
                    <field name="priority" readonly="1"
                           groups="customer_support_module.group_support_manager,
                                   customer_support_module.group_support_agent,
                                   customer_support_module.group_support_admin" widget="priority"/>
                    <field name="phase_id"
                           groups="customer_support_module.group_support_agent"/>
                    <field name="agent_reply"
                           groups="customer_support_module.group_support_agent"/>
                    <field name="agent_reply" readonly="1"
                           groups="customer_support_module.group_support_customer,
                                   customer_support_module.group_support_manager,
                                   customer_support_module.group_support_admin"/>
                </group>

                <group>
                    <field name="image" widget="image" class="oe_avatar" nolabel="1"/>
                </group>
                <button name="action_create_ticket"
                        type="object"
                        string="Add Ticket"
                        class="btn-primary"
                        icon="fa-plus"
                        groups="customer_support_module.group_support_customer"/>
                        
                <button name="action_submit_reply"
                            string="Submit Reply"
                            type="object"
                            class="btn-primary"
                            groups="customer_support_module.group_support_agent"/>
                <button name="action_assign_agent"
                    string="Assign Agent"
                    type="object"
                    class="btn-primary"
                    groups="customer_support_module.group_support_manager"/>
            </sheet>
            
        </form>
    </field>
</record>


    <!-- CALENDAR VIEW -->
    <record id="customer_support_module_calendar_view" model="ir.ui.view">
        <field name="name">customer.support.module.calendar.view</field>
        <field name="model">customer.support.module</field>
        <field name="arch" type="xml">
            <calendar string="Support Calendar" date_start="date" date_stop="date" color="assigned_user_id">
                <field name="subject"/>
                <field name="priority"/>
                <field name="assigned_user_id"/>
            </calendar>
        </field>
    </record>

    <!-- GRAPH VIEWS -->
    <record id="customer_support_module_graph_phase_view" model="ir.ui.view">
        <field name="name">customer.support.module.graph.phase.view</field>
        <field name="model">customer.support.module</field>
        <field name="arch" type="xml">
            <graph string="Tickets by Phase" type="bar">
                <field name="id" type="measure"/>
                <field name="phase_id" type="row"/>
                <field name="priority" type="col"/>
            </graph>
        </field>
    </record>

    <record id="customer_support_module_graph_agent_view" model="ir.ui.view">
        <field name="name">customer.support.module.graph.agent.view</field>
        <field name="model">customer.support.module</field>
        <field name="arch" type="xml">
            <graph string="Tickets by Agent" type="pie">
                <field name="id" type="measure"/>
                <field name="assigned_user_id" type="row"/>
            </graph>
        </field>
    </record>

    <record id="customer_support_module_graph_time_view" model="ir.ui.view">
        <field name="name">customer.support.module.graph.time.view</field>
        <field name="model">customer.support.module</field>
        <field name="arch" type="xml">
            <graph string="Tickets Over Time" type="line">
                <field name="id" type="measure"/>
                <field name="date" type="col"/>
                <field name="priority" type="row"/>
            </graph>
        </field>
    </record>
    
  <!-- Action -->
  <record id="customer_support_module_action" model="ir.actions.act_window">
      <field name="name">Ticket</field>
      <field name="res_model">customer.support.module</field>
      <field name="view_mode">kanban,list,form,calendar,graph</field>
      
  </record>

  <!-- Menus -->
  <menuitem id="custom_root_menu"
            name="Customer Support Module"/>

  <menuitem id="custom_sub_root_menu"
            name="Tasks"
            parent="custom_root_menu"/>

  <menuitem id="customer_support_menu"
            action="customer_support_module_action"
            name="Ticket"
            sequence="2"
            parent="custom_sub_root_menu"/>
</odoo>